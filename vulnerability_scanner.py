import requests
from bs4 import BeautifulSoup
import argparse

def scan_url(url):
    try:
        headers = {'User-Agent': 'Mozilla/5.0'}
        response = requests.get(url, headers=headers)

        if response.status_code == 200:
            print(f"Scanning {url}...")
            # Example: Check for common vulnerabilities
            payloads = [
                "' OR '1'='1",
                "<script>alert('XSS')</script>",
                "; ls -la",
                "*)(|(objectClass=*)",
                "; echo 'pwned' > /tmp/pwned",
                "' AND IF(SUBSTR((SELECT password FROM users WHERE username='admin'),1,1)='a', SLEEP(5), 0) --",
                "?page=../../../../etc/passwd",
                "{ \"$where\": \"this.username == 'admin' && 'a'\" }",
                "<?xml version=\"1.0\"?><!DOCTYPE root [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><root>&xxe;</root>",
                "X-Forwarded-For: 127.0.0.1"
            ]

            for payload in payloads:
                if payload in response.text.lower():
                    print(f"[!] Vulnerability found at {url} with payload: {payload}")
                    break
            else:
                print(f"[+] No vulnerabilities found at {url}")
        else:
            print(f"[!] Failed to access {url}: {response.status_code}")
    except requests.exceptions.RequestException as e:
        print(f"[!] Error scanning {url}: {e}")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='Vulnerability Scanner')
    parser.add_argument('-u', '--url', type=str, help='URL to scan')
    args = parser.parse_args()

    if args.url:
        scan_url(args.url)
    else:
        print("Please provide a URL to scan using the -u option.")